<!DOCTYPE html>
<html>
<head>
<style>
em {
    font-size: 110%;
}
code {
    font-size: 110%;
}
pre {
    font-size: 125%;
}
</style>
<title>SIREN Notes</title>
</head>
</body>
<h2>Building SIREN from github and SourceForge</h2>
<p>This is a brief set of clues on how to get SIREN working using the source from github and packages from SourceForge. More may be forthcoming. The SIREN help file (<a href="help.html" target="_blank">help.html</a>) is worth a read. In terms of setup refer to :-
<a href="help.html#install" target="_blank">Installation</a>, <a href="help.html#setup" target="_blank">Setting Up</a>, <a href="help.html#prefs" target="_blank">Preferences</a>, and <a href="help.html#files" target="_blank">SIREN File Formats</a>. To use SIREN refer to <a href="help.html#usage" target="_blank">Using the Simulation</a>.</p>
<p>SIREN is packaged for Windows to enable that user base to install and use it with minimal technical knowledge. This version has been created with PyInstaller (see below). It has also been executed successfully on Mac using <code>WineBottler</code>. To run it in other environments, or to run your own Windows version you need:
<ul>
<li>Python 3.?</li>
<li>Some Python packages (see <a href="#libraries">Python Libraries</a>)</li>
<li>The Python source programs for SIREN. These are available either from <a href="#github">github</a> or <a href="#forge">SourceForge</a>. Their purpose is briefly described in <a href="#source">SIREN Programs</a></li>
<li>The SAM SDK. This included in a number of the SourceForge zip files (<em>siren_toolkit.exe</em> and <em>siren_application.exe</em>). It is also available from the SAM website - <a href="https://sam.nrel.gov/sdk" target="_blank">https://sam.nrel.gov/sdk</a>. SIREN currently uses <a href="https://github.com/NREL/ssc/releases/tag/2018.11.11.r2" target="_blank">Version 2019-02-09</a> (206)</li>
<li>Other data files as indicated in <a href="help.html#setup" target="_blank">Setting Up</a>. These are found in some of the SIREN SourceForge downloads with a small number also available on github</li>
<li>If required, the sample SIREN simulation of the SWIS - <em>siren_sample.exe</em>
</ul>
<h2 id="github">github</h2>
<p><a href="https://github.com/ozsolarwind/siren" target="_blank">https://github.com/ozsolarwind/siren</a> contains the Python source and associated image files for SIREN plus a few additional items:</p>
<ul>
<li>Individual turbine (.pow) files for turbines not included in SAM's wind turbine file. The location for these is defined by the <em>pow_files</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file</li>
<li>Spreadsheets with default parameters for the SAM models. The location for these is defined by the <em>variable_files</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file and the files themselves are defined by the <a href="help.html#p_sam_modules"> [SAM Modules]</a> Section</li>
<li>SAM wind turbine files - <em>Wind Turbines.csv</em> and <em>Wind Turbine Subset.csv</em>. The location for these is defined by the <em>sam_turbines</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file</li>
<li><em>siren_application.spec</em> is the specification file used to package the SIREN application using PyInstaller</li>
<li>You can also view the SIREN help file at <a href="https://rawgit.com/ozsolarwind/siren/master/help.html" target="_blank">https://rawgit.com/ozsolarwind/siren/master/help.html</a>
</ul>
<p>You should download all files (except the spec file) to your target &ldquo;home&rdquo; folder for SIREN.<p>
<h2>SourceForge</h2>
<p><a href="https://sourceforge.net/projects/sensiren/" target="_blank">https://sourceforge.net/projects/sensiren/</a> contains a number of self-extracting zip files for the full SIREN Toolkit and a number of the components. See <a href="help.html#install" target="_blank">Installation</a>.
<ul>
<li><em>siren_application.exe</em> and <em>siren_toolkit.exe</em> contain the SIREN Python source (<em>siren/source</em> folder) and SAM SDK (<em>siren/sam-sdk</em> folder)</li>
<li><em>siren_toolkit.exe</em> and <em>siren_sample.exe</em> contain the sample SIREN simulation of the SWIS (<em>siren_sample</em> folder)</li>
<li><em>siren_makeweatherfiles.exe</em> provides the files required to create SAM weather files without requiring any other parts of SIREN</li>
</ul>
<h2 id="libraries">Python Libraries</h2>
<p>These libraries may need to be installed using either pip3 or your software installer.</p>
<table><tr><td><strong>Library</strong></td><td><strong>Standard library?</strong></td><td><strong>Notes</strong></td</tr>
<tr><td>configparser</td><td style="text-align:center">y</td></tr>
<tr><td>csv</td><td style="text-align:center">y</td></tr>
<tr><td>ctypes</td><td style="text-align:center">y</td></tr>
<tr><td>datetime</td><td style="text-align:center">y</td></tr>
<tr><td>et_xmlfile</td><td>&nbsp;</td><td>Windows. Required by openpyxl?</td></tr>
<tr><td>functools</td><td style="text-align:center">y</td></tr>
<tr><td>gzip</td><td style="text-align:center">y</td></tr>
<tr><td>heapq</td><td style="text-align:center">y</td></tr>
<tr><td>http.client</td><td style="text-align:center">y</td></tr>
<tr><td>io</td><td style="text-align:center">y</td></tr>
<tr><td>jdcal</td><td>&nbsp;</td><td>Windows. Required by openpyxl</td</tr>
<tr><td>math</td><td style="text-align:center">y</td></tr>
<tr><td>matplotlib</td></tr>
<tr><td>mpl_toolkits</td><td>&nbsp;</td><td>Note: Must have basemap/data/epsg file.</td></tr>
<tr><td>netCDF4</td></tr>
<tr><td>numpy</td></tr>
<tr><td>openpyxl</td></tr>
<tr><td>os</td><td style="text-align:center">y</td></tr>
<tr><td>pwd</td><td style="text-align:center">y</td><td style="text-align:center">Linux</td></td></tr>
<tr><td>pyexcel</td><td>&nbsp;</td><td>Support for spreadsheets</td></td></tr>
<tr><td>pyexcel-io</td><td>&nbsp;</td><td>CSV files</td></td></tr>
<tr><td>pyexcel-ods</td><td>&nbsp;</td><td>ODS (LibreOffice) files</td></td></tr>
<tr><td>pyexcel-xls</td><td>&nbsp;</td><td>XLS and XLSX (Excel) files</td></td></tr>
<tr><td>pylab</td></tr>
<tr><td>pyproj</td><td>&nbsp;</td><td>Windows?</td></tr>
<tr><td>PyQt5</td></tr>
<tr><td>python3-pil</td></tr>
<tr><td>python3-pil.imagetk</td></tr>
<tr><td>python3-tk</td><td style="text-align:center">y</td></tr>
<tr><td>random</td><td style="text-align:center">y</td></tr>
<tr><td>scipy</td></tr>
<tr><td>shutil</td><td style="text-align:center">y</td></tr>
<tr><td>ssc</td><td>&nbsp;</td><td>SAM</td></tr>
<tr><td>struct</td><td style="text-align:center">y</td></tr>
<tr><td>subprocess</td><td style="text-align:center">y</td></tr>
<tr><td>sys</td><td style="text-align:center">y</td></tr>
<tr><td>tempfile</td><td style="text-align:center">y</td></tr>
<tr><td>time</td></tr>
<tr><td>urllib3</td></tr>
<tr><td>webbrowser</td><td style="text-align:center">y</td></tr>
<tr><td>win32api</td><td>&nbsp;</td><td>Windows</td></tr>
<tr><td>xlrd</td></tr>
<tr><td>xlwt</td></tr>
<tr><td>xml.etree.ElementTree</td><td style="text-align:center">y</td></tr>
<tr><td>zipfile</td><td style="text-align:center">y</td></tr>
</table>
<p>
<h2 id="source">SIREN Programs</h2>
<p>This is a list of the Python source programs for SIREN. Where there is a dependency on the os environment the programs test <code>sys.platform</code>. These programs are highlighted in the list with an asterisk (*).</p>
<table><tr><td><strong>Program</strong></td><td><strong>Purpose</strong></td></tr>
<tr><td>colours.py</td><td>Display update colours for objects</td></tr>
<tr><td>credits.py (*)</td><td>Display SIREN Credits window</td></tr>
<tr><td>dijkstra_4.py</td><td>Find shortest path to grid and to load centre</td></tr>
<tr><td>displayobject.py (*)</td><td>Display an object</td></tr>
<tr><td>displaytable.py</td><td>Display a table</td></tr>
<tr><td>editini.py (*)</td><td>Edit window for Preferences (model) file</td></tr>
<tr><td style="vertical-align:top">flexiplot.py</td><td>A standalone program that can be used to produce plots from a spreadsheet that contains data in rows or columns
<br />This uses pyexcel to allow flexibility in input file formats, but seems to perform quite poorly due to that choice</td></tr>
<tr><td>floaters.py</td><td>Display floating windows for legend, menu, status, and progress bar</td></tr>
<tr><td>getmap.py</td><td>Download map tiles to create a map image</td></tr>
<tr><td>getmerra2.py (*)</td><td>Invoke wget to download MERRA-2 files</td></tr>
<tr><td>getmodels.py</td><td>Provides a location pointer to the SIREN Preferences (model) files</td></tr>
<tr><td>grid.py</td><td>Grid class. Process grid items</td></tr>
<tr><td>indexweather.py</td><td>Create index file for weather files</td></tr>
<tr><td>inisyntax.py</td><td>Syntax highlighting for Preferences Edit window</td></tr>
<tr><td>makegrid.py</td><td>Create weather grid files</td></tr>
<tr><td><del>makerainfall2.py</del></td><td><del>Create rainfall files from MERRA-2 data</del></td></tr>
<tr><td><del>makeweather2.py</del></td><td><del>Create weather files from MERRA-2 data</del></td></tr>
<tr><td>makeweatherfiles.py (*)</td><td>Standalone program to create weather files from MERRA-2 data</td></tr>
<tr><td>newstation.py</td><td>Create/edit a new power station</td></tr>
<tr><td>parents.py (*)</td><td>Adjust file names from Parents properties in config (.ini) file</td></tr>
<tr><td>plotweather.py (*)</td><td>Plot (graph) weather data</td></tr>
<tr><td>powerclasses.py</td><td>Classes used by PowerModel (powermodel.py)</td></tr>
<tr><td>powermatch.py</td><td>Match generation to load. Produce costed scenarios</td></tr>
<tr><td>powermodel.py (*)</td><td>Process SAM models for stations to produce spreadsheets and plots</td></tr>
<tr><td>powerplot.py</td><td>A standalone program that will produce either hourly or diurnal plots from a spreadsheet that conforms to certain constraints</td></tr>
<tr><td>sammodels.py</td><td>Routines for SAM/NREL models for DHI, DNI and Zenith angle</td></tr>
<tr><td>samrun.py</td><td>Run a SAM model</td></tr>
<tr><td>senuser.py (*)</td><td>Obtain current userid details</td></tr>
<tr><td>siren.py (*)</td><td>Display a menu of SIREN Models (invokes sirenm.py for the chosen Model)</td></tr>
<tr><td>sirenicons.py</td><td>Get a technology icon</td></tr>
<tr><td>sirenm.py (*)</td><td>Main SIREN program</td></tr>
<tr><td>sirenupd.py</td><td>Update to newer SIREN programs without having to download the full toolkit</td></tr>
<tr><td>ssc.py (*)</td><td>Access SAM models</td></tr>
<tr><td>station.py</td><td>Station class. Populate stations from files and scenarios</td></tr>
<tr><td>superpower.py</td><td>SuperPower class called by PowerModel (powermodel.py)</td></tr>
<tr><td>towns.py</td><td>Town class. Populate towns from files</td></tr>
<tr><td>turbine.py</td><td>Turbine class.</td></tr>
<tr><td>updateswis.py</td><td>Check and update SWIS stations and load</td></tr>
<tr><td>viewresource.py (*)</td><td>Overlay energy resource grid over map</td></tr>
<tr><td>visualise.py (*)</td><td>Visualise hourly generation on map</td></tr>
<tr><td>wascene.py</td><td>Create and manage displayed map</td></tr>
<tr><td>worldwindow.py</td><td>Display a world map for getmap and getmerra2</td></tr>
<tr><td>zoompan.py</td><td>Implement a more dynamic zoom and pan for hourly plots</td></tr>
</table>
<h2>Packaging for Windows</h2>
<p>I use PyInstaller (currently Version 3.4) to package SIREN for Windows. I use the multi-package facility to create executables for <code>siren.py, sirenm.py</code> and the tools (<code>flexiplot.py, getmap.py, getmerra2.py, indexweather.py, makegrid.py, makeweatherfiles.py, powermatch.py, powerplot.py, sirenupd.py</code> and <code>updateswis.py</code>). <code>siren_application.spec</code> is the spec file (<code>pyinstaller.exe siren_application.spec</code> with options <code>--log-level ERROR</code> and/or <code>--noconfirm</code> ... <code>pyinstaller.exe --noconfirm --log-level ERROR siren_application.spec</code>). This enables all programs to be included in a single library for distribution. PyInstaller places them in individual directories - I use <code>package_siren.py</code> to copy all the executables into the <em>siren</em> directory and remove some unwanted files that are included as part of the packaging process.</p>
<p>All these files have a version file where the version is <em>&lt;major&gt;,&lt;minor&gt;.&lt;yyyy&gt;.&lt;mmdd&gt;</em>. <em>&lt;major&gt;</em> and <em>&lt;minor&gt;</em> refer to the SIREN release. The date part is the date the program was last changed. The version numbering simulates Microsoft version numbers. <code>template_version</code> provides a template for the version files to enable new SIREN releases to be packaged. The current <em>major</em> version is <strong><em>3</em></strong> (<em>1</em> was the initial version, <em>2</em> for the change from Python2 to Python3, <em>3</em> for the change from PyQt4 to PyQt5).</p>
<p>To enable the modules to be built correctly most require <em>hiddenimports</em>, as identified in <code>siren_application.spec</code>, as often PyInstaller will fail to identify all imports from libraries used by the SIREN program.</p>
<p><code>makeweather_getmerra2.spec</code> and <code>package_makeweatherfiles.py</code> package <code>makeweatherfiles.py</code> and <code>getmerra2.py</code> to provide a standalone tool to create SAM weather files from MERRA-2 datasets.</p>
<h2>Useful tools</h2>
<h3>sam_models_list</h3>
<p>The parameters and variables utilised by the SAM API often change between versions. <code>sam_models_list.py</code> can be run to list the SAM models and variables for different SAM versions. Usage:</p>
<ul style="list-style-type:none">
<li><code>python sam_models_list.py</code> &rArr; Produce HTML file of models for current SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt;</code> &rArr; Produce HTML file of models for chosen SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt; &lt;SAM model&gt;</code> &rArr; Produce spreadsheet of variables for model of chosen SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt; &lt;SAM model&gt; &lt;Ver 1&gt; &lt;Ver 2&gt;</code>Produce spreadsheet comparing model variables between two SSC versions</li>
</ul>
<p>Where:</p>
<ul style="list-style-type:none">
<li><code>&lt;Preference file&gt;</code> is a SIREN Prefences (.ini) file containing the directory for the SAM SDK</li>
<li><code>&lt;SAM model&gt;</code> is a SAM Model</li>
<li><code>&lt;Ver n&gt;</code> is an SDK Version<li>
</ul>
<h3>opt_debug</h3>
<p><code>opt_debug.py</code> can be used to debug the <code>powermatch</code> optimisation routine. It doesn't need to be packaged with SIREN.</p>
<p>Angus King<br />December 2021</p>
</body>
