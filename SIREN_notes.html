
<!DOCTYPE html>
<html>
<head>
<style>
em {
    font-size: 110%;
}
code {
    font-size: 110%;
}
pre {
    font-size: 125%;
}
</style>
<title>SIREN Notes</title>
</head>
</body>
<h2>Building SIREN from github and SourceForge</h2>
<p>This is a brief set of clues on how to get SIREN working using the source from github and packages from SourceForge. More may be forthcoming. The SIREN help file (<a href="help.html" target="_blank">help.html</a>) is worth a read. In terms of setup refer to :-
<a href="help.html#install" target="_blank">Installation</a>, <a href="help.html#setup" target="_blank">Setting Up</a>, <a href="help.html#prefs" target="_blank">Preferences</a>, and <a href="help.html#files" target="_blank">SIREN File Formats</a>. To use SIREN refer to <a href="help.html#usage" target="_blank">Using the Simulation</a>.</p>
<p>SIREN is packaged for Windows to enable that user base to install and use it with minimal technical knowledge. This version has been created with PyInstaller. To run it in other environments, or to run your own Windows version you need:
<ul>
<li>Python 2.7</li>
<li>Some Python packages (see <a href="#libraries">Python Libraries</a>)</li>
<li>The Python source programs for SIREN. These are available either from <a href="#github">github</a> or <a href="#forge">SourceForge</a>. Their purpose is briefly described in <a href="#source">SIREN Programs</a></li>
<li>The SAM SDK. This included in a number of the SourceForge zip files (<em>siren_toolkit.exe</em> and <em>siren_application.exe</em>). It is also available from the SAM website - <a href="https://sam.nrel.gov/sdk" target="_blank">https://sam.nrel.gov/sdk</a>. SIREN currently uses <a href="https://sam.nrel.gov/system/tdf/content/sdk/sam-sdk-2016-3-14-r2.zip?file=1" target="_blank">Version 2016-3-14</a></li>
<li>Other data files as indicated in <a href="help.html#setup" target="_blank">Setting Up</a>. These are found in some of the SIREN SourceForge downloads with a small number also available on github</li>
<li>If required, the sample SIREN simulation of the SWIS - <em>siren_sample.exe</em>
</ul>
<h2 id="github">github</h2>
<p><a href="https://github.com/ozsolarwind/siren" target="_blank">https://github.com/ozsolarwind/siren</a> contains the Python source and associated image files for SIREN plus a few additional items:</p>
<ul>
<li>Individual turbine (.pow) files for turbines not included in SAM's wind turbine file. The location for these is defined by the <em>pow_files</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file</li>
<li>Spreadsheets with default parameters for the SAM models. The location for these is defined by the <em>variable_files</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file and the files themselves are defined by the <a href="help.html#p_sam_modules"> [SAM Modules]</a> Section</li>
<li>SAM wind turbine files - <em>Wind Turbines.csv</em> and <em>Wind Turbine Subset.csv</em>. The location for these is defined by the <em>sam_turbines</em> property of the <a href="help.html#p_files" target="_blank">[Files]</a> Section of the Preferences file</li>
<li><em>siren_application.spec</em> is the specification file used to package the SIREN application using PyInstaller.
</ul>
<p>You should download all files (except the spec file) to your target &ldquo;home&rdquo; folder for SIREN.<p>
<h2>SourceForge</h2>
<p><a href="https://sourceforge.net/projects/sensiren/" target="_blank">https://sourceforge.net/projects/sensiren/</a> contains a number of self-extracting zip files for the full SIREN Toolkit and a number of the components. See <a href="help.html#install" target="_blank">Installation</a>.
<ul>
<li><em>siren_application.exe</em> and <em>siren_toolkit.exe</em> contain the SIREN Python source (<em>siren/source</em> folder) and SAM SDK (<em>siren/sam-sdk</em> folder)</li>
<li><em>siren_toolkit.exe</em> and <em>siren_sample.exe</em> contain the sample SIREN simulation of the SWIS (<em>siren_sample</em> folder)</li>
<li><em>siren_makeweatherfiles.exe</em> provides the files required to create SAM weather files without requiring any other parts of SIREN</li>
</ul>
<h2 id="libraries">Python Libraries</h2>
<table><tr><td><strong>Library</strong></td><td><strong>Notes</strong></td</tr>
<tr><td>ConfigParser</td></tr>
<tr><td>csv</td></tr>
<tr><td>ctypes</td></tr>
<tr><td>datetime</td></tr>
<tr><td>et_xmlfile</td><td>Windows. Required by openpyxl</td></tr>
<tr><td>functools</td></tr>
<tr><td>gzip</td></tr>
<tr><td>heapq</td></tr>
<tr><td>httplib</td></tr>
<tr><td>jdcal</td><td>Windows. Required by openpyxl</td</tr>
<tr><td>math</td></tr>
<tr><td>matplotlib</td></tr>
<tr><td>mpl_toolkits</td></tr>
<tr><td>netCDF4</td></tr>
<tr><td>numpy</td></tr>
<tr><td>openpyxl</td></tr>
<tr><td>os</td></tr>
<tr><td>pwd</td><td>Linux</td></tr>
<tr><td>pylab</td></tr>
<tr><td>PyQt4</td></tr>
<tr><td>scipy</td></tr>
<tr><td>ssc</td><td>SAM</td></tr>
<tr><td>struct</td></tr>
<tr><td>subprocess</td></tr>
<tr><td>sys</td></tr>
<tr><td>tempfile</td></tr>
<tr><td>time</td></tr>
<tr><td>webbrowser</td></tr>
<tr><td>win32api</td><td>Windows</td></tr>
<tr><td>xlrd</td></tr>
<tr><td>xlwt</td></tr>
<tr><td>xml.etree.ElementTree</td></tr>
</table>
<h2 id="source">SIREN Programs</h2>
<p>This is a list of the Python source programs for SIREN. Where there is a dependency on the os environment the programs test <code>sys.platform</code>. These programs are highlighted in the list with an asterisk (*).</p>
<table><tr><td><strong>Program</strong></td><td><strong>Purpose</strong></td></tr>
<tr><td>colours.py</td><td>Display update colours for objects</td></tr>
<tr><td>credits.py (*)</td><td>Display SIREN Credits window</td></tr>
<tr><td>dijkstra_4.py</td><td>Find shortest path to grid and to load centre</td></tr>
<tr><td>displayobject.py (*)</td><td>Display an object</td></tr>
<tr><td>displaytable.py</td><td>Display a table</td></tr>
<tr><td>editini.py (*)</td><td>Edit window for Preferences (model) file</td></tr>
<tr><td>floatlegend.py</td><td>Display legend window</td></tr>
<tr><td>floatmenu.py</td><td>Display menu window</td></tr>
<tr><td>floatstatus.py</td><td>Display status window</td></tr>
<tr><td>getmap.py</td><td>Download map tiles to create a map image</td></tr>
<tr><td>getmerra2.py (*)</td><td>Invoke wget to download MERRA-2 files</td></tr>
<tr><td>grid.py</td><td>Grid class. Process grid items</td></tr>
<tr><td>indexweather.py</td><td>Create index file for weather files</td></tr>
<tr><td>inisyntax.py</td><td>Syntax highlighting for Preferences Edit window</td></tr>
<tr><td>makegrid.py</td><td>Create weather grid files</td></tr>
<tr><td>makerainfall2.py (*)</td><td>Create rainfall files from MERRA-2 data</td></tr>
<tr><td>makeweather2.py (*)</td><td>Create weather files from MERRA-2 data</td></tr>
<tr><td>makeweatherfiles.py (*)</td><td>Standalone program to create weather files from MERRA-2 data</td></tr>
<tr><td>newstation.py</td><td>Create/edit a new power station</td></tr>
<tr><td>parents.py (*)</td><td>Adjust file names from Parents properties in config (.ini) file</td></tr>
<tr><td>plotweather.py (*)</td><td>Plot (graph) weather data</td></tr>
<tr><td>powerbalance2.py</td><td>PowerBalance implementation. Produce costed scenarios</td></tr>
<tr><td>powermodel.py (*)</td><td>Process SAM models for stations to produce spreadsheets and plots</td></tr>
<tr><td>sammodels.py</td><td>Routines for SAM/NREL models for DHI, DNI and Zenith angle</td></tr>
<tr><td>samrun.py</td><td>Run a SAM model</td></tr>
<tr><td>senuser.py (*)</td><td>Obtain current userid details</td></tr>
<tr><td>siren.py (*)</td><td>Display a menu of SIREN Models (invokes sirenm.py for the chosen Model)</td></tr>
<tr><td>sirenicons.py</td><td>Get a technology icon</td></tr>
<tr><td>sirenm.py (*)</td><td>Main SIREN program</td></tr>
<tr><td>sirenupd.py (*)</td><td>Update to newer SIREN programs without having to download the full toolkit</td></tr>
<tr><td>ssc.py (*)</td><td>Access SAM models</td></tr>
<tr><td>station.py</td><td>Station class. Populate stations from files and scenarios</td></tr>
<tr><td>towns.py</td><td>Town class. Populate towns from files</td></tr>
<tr><td>turbine.py</td><td>Turbine class.</td></tr>
<tr><td>updateswis.py</td><td>Check and update SWIS stations and load</td></tr>
<tr><td>viewresource.py (*)</td><td>Overlay energy resource grid over map</td></tr>
<tr><td>visualise.py (*)</td><td>Visualise hourly generation on map</td></tr>
<tr><td>wascene.py</td><td>Create and manage displayed map</td></tr>
<tr><td>worldwindow.py</td><td>Display a world map for getmap and getmerra2</td></tr>
</table>
<h2>Packaging for Windows</h2>
<p>I use <em>pyinstaller</em> (currently Version 3.2.1) to package SIREN for Windows. I use the multi-package facility to create executables for <code>siren.py, sirenm.py</code> and the tools (<code>getmap.py, getmerra2.py, indexweather.py, makerainfall2.py, makegrid.py, makeweather2.py, sirenupd.py</code> and <code>updateswis.py</code>). <code>siren_application.spec</code> is the spec file (<code>c:\Python27\scripts\pyinstaller.exe siren-application.spec</code>). This enables all programs to be included in a single library for distribution. <em>pyinstaller</em> places them in individual directories - I use <code>package_siren.py</code> to copy all the executables into the <em>siren</em> directory and remove some unwanted files that are included as part of the packaging process. All these have a version file where the version is <em>&lt;version&gt;,&lt;modification&gt;.&lt;yyyy&gt;.&lt;mmdd&gt;</em> The date part is the date the program was last changed.</p>
<p><code>makeweather_getmerra2.spec</code> and <code>package_makeweatherfiles.py</code> package <code>makeweatherfiles.py</code> and <code>getmerra2.py</code> to provide a standalone tool to create SAM weather files from MERRA-2 datasets.</p>
<h2>Useful tools</h2>
<p>The parameters and variables utilised by the SAM API often change between versions. <code>sam_models_list.py</code> can be run to list the SAM models and variables for different SAM versions. Usage:</p>
<ul style="list-style-type:none">
<li><code>python sam_models_list.py</code> &rArr; Produce HTML file of models for current SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt;</code> &rArr; Produce HTML file of models for chosen SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt; &lt;SAM model&gt;</code> &rArr; Produce spreadsheet of variables for model of chosen SSC version</li>
<li><code>python sam_models_list.py &lt;Preference file&gt; &lt;SAM model&gt; &lt;Ver 1&gt; &lt;Ver 2&gt;</code>Produce spreadsheet comparing model variables between two SSC versions</li>
</ul>
<p>Where:</p>
<ul style="list-style-type:none">
<li><code>&lt;Preference file&gt;</code> is a SIREN Prefences (.ini) file containing the directory for the SAM SDK</li>
<li><code>&lt;SAM model&gt;</code> is a SAM Model</li>
<li><code>&lt;Ver n&gt;</code> is an SDK Version<li>
</ul>
</body>
